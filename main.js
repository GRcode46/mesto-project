(()=>{"use strict";var e="57b8df36-44ff-41fe-a89b-2cd5bf92b88e",t="".concat("https://nomoreparties.co","/").concat("v1","/").concat("plus-cohort-10","/"),n={},o="cards",r="users/me",c=document.querySelectorAll(".button__popup-close"),i=document.querySelector("#edit-card-btn-submit"),u=document.querySelector(".profile"),a=u.querySelector(".profile__btn-edit"),l=u.querySelector(".profile__title"),s=u.querySelector(".profile__subtitle"),d=u.querySelector(".profile__avatar"),p=document.querySelector("#popup-profile"),f=document.querySelector("#profile-popup-form"),m=f.querySelector("#popup-profile-title"),v=f.querySelector("#popup-profile-subtitle"),_=document.querySelector("#popup-element"),y=document.querySelector("#card-popup-form"),S=document.querySelector(".profile__btn-add"),h=document.querySelector("#element-name"),b=document.querySelector("#element-url"),q=document.querySelector(".elements__list"),E=document.querySelector("#element-template").content,L=document.querySelector("#popup-preview"),g=L.querySelector(".popup-preview__image"),C=L.querySelector(".popup-preview__title"),k=document.querySelector("#popup-card-delete-confirmation"),w=k.querySelector("#card-del-btn-submit"),x=k.querySelector("#card-del-btn-cancel");function A(n){return fetch("".concat(t).concat(n),{headers:{authorization:e}}).then((function(e){return e.json()})).then((function(e){return e}))}function j(e,t,o,r,c){var i=E.querySelector(".element").cloneNode(!0),u=i.querySelector(".element__btn-like"),a=i.querySelector(".element__image"),l=i.querySelector(".element__trash");return i.querySelector(".element__like-counter").textContent=o.length,i.querySelector(".element__name").textContent=e,a.src=t,a.alt=e,u.addEventListener("click",(function(){return u.classList.toggle("element__btn-like_active")})),r===n.id?(i.setAttribute("id",c),l.addEventListener("click",(function(e){var t;t=c,D(k),w.setAttribute("data-id",t)}))):l.classList.add("element__trash_disabled"),a.addEventListener("click",(function(){var n,o;n=t,o=e,D(L),g.src=n,C.textContent=o,g.alt=o})),i}function B(e){q.prepend(e)}function T(e){e.target===e.currentTarget&&N(e.target)}function z(e){"Escape"===e.key&&N(document.querySelector(".popup_opened"))}function D(e){e.classList.add("popup_opened"),window.addEventListener("keydown",z),e.addEventListener("click",T)}function N(e){e.classList.remove("popup_opened"),window.removeEventListener("keydown",z),e.removeEventListener("click",T)}var O,J=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)};c.forEach((function(e){e.addEventListener("click",(function(e){N(e.target.closest("div.popup"))}))})),a.addEventListener("click",(function(){var e;e=p,m.value=l.textContent,v.value=s.textContent,D(e)})),S.addEventListener("click",(function(){D(_)})),_.addEventListener("submit",(function(n){n.preventDefault();var r={name:h.value,link:b.value};(function(n,o){(function(n,o){return fetch("".concat(t).concat(n),{method:"POST",headers:{authorization:e,"Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(e){return e}))})(n,o).then((function(e){B(j(e.name,e.link,e.likes,e.owner._id,e._id)),y.reset(),i.disabled=!0,i.classList.add("button_state_inactive")})).catch((function(e){console.log(e)}))})(o,r),N(_)})),f.addEventListener("submit",(function(n){n.preventDefault();var o,r={name:m.value,about:v.value};(o=r,fetch("".concat(t).concat("users/me"),{method:"PATCH",headers:{authorization:e,"Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(e){return e}))).then((function(e){l.textContent=e.name,s.textContent=e.about})).catch((function(e){console.log(e)})),N(p)})),w.addEventListener("click",(function(n){!function(n,o){console.log(o.target.dataset.id);var r,c,i=o.target.dataset.id;(r=n,c=i,fetch("".concat(t).concat(r,"/").concat(c),{method:"DELETE",headers:{authorization:e}}).then((function(e){return e.json()})).then((function(e){return e}))).then((function(e){document.getElementById(i).remove(),N(k)})).catch((function(e){console.log(e)}))}(o,n)})),x.addEventListener("click",(function(e){N(e.target.closest("div.popup")),w.removeAttribute("data-id")})),O={formSelector:".popup__form",inputSelector:".form__input",submitButtonSelector:".popup__btn-submit",inactiveButtonClass:"button_state_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},Array.from(document.querySelectorAll(O.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);J(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,t.validationMessage,n)}(e,r,t),J(n,o,t)}))}))}(e,O)})),function(e){A(e).then((function(e){l.textContent=e.name,s.textContent=e.about,n.id=e._id})).catch((function(e){console.log(e)}))}(r),A("users/me").then((function(e){d.src=e.avatar})).catch((function(e){console.log(e)})),A("cards").then((function(e){e.reverse().forEach((function(e){B(j(e.name,e.link,e.likes,e.owner._id,e._id))}))})).catch((function(e){console.log(e)}))})();